# Pipeline Configuration
# Edit these values according to your system

# Network Interface Configuration
NETWORK_INTERFACE="enx00e04c36074c"              # Interface to bind to DPDK (will be taken offline!)
INTERFACE_PCI_ADDRESS=""              # Auto-detected if empty
DPDK_DRIVER="vfio-pci"               # Options: vfio-pci, uio_pci_generic, igb_uio

# DPDK Configuration
DPDK_HUGEPAGES="2048"                # Hugepages in MB (2GB default)
DPDK_CORES="0,1"                     # CPU cores for DPDK (comma-separated)
DPDK_MEMORY_CHANNELS="4"             # Memory channels

# Suricata Configuration
SURICATA_CONFIG="/etc/suricata/suricata-dpdk.yaml"
SURICATA_LOG_DIR="/var/log/suricata"
SURICATA_CORES="2"                   # Number of worker threads
SURICATA_HOME_NET="192.168.0.0/16"   # Your network range
SURICATA_EXTERNAL_NET="!$HOME_NET"

# Kafka Configuration
KAFKA_BOOTSTRAP_SERVERS="localhost:9092"
KAFKA_TOPIC_ALERTS="suricata-alerts"
KAFKA_TOPIC_ML_PREDICTIONS="ml-predictions"
KAFKA_GROUP_ID="ids-ml-consumer"
KAFKA_AUTO_OFFSET_RESET="latest"     # Options: earliest, latest

# ML Configuration
ML_MODEL_PATH="../ML Models/random_forest_model_2017.joblib"
ML_BATCH_SIZE="100"                  # Batch predictions for efficiency
ML_CONFIDENCE_THRESHOLD="0.7"        # Minimum confidence for alerts
ML_FEATURES_CONFIG="../config/ids_config.yaml"

# Traffic Replay Configuration
PCAP_REPLAY_INTERFACE="$NETWORK_INTERFACE"
PCAP_REPLAY_SPEED="10"               # Mbps (0 = max speed)
PCAP_LOOP_COUNT="1"                  # Number of times to loop PCAP

# Logging
LOG_DIR="../logs"
LOG_LEVEL="INFO"                     # Options: DEBUG, INFO, WARNING, ERROR

# Performance
ENABLE_PERFORMANCE_MONITORING="true"
STATS_INTERVAL_SECONDS="10"

# Safety
UNBIND_ON_EXIT="true"                # Restore interface on script exit
BACKUP_INTERFACE_CONFIG="true"       # Backup interface config before binding
