# Network Topology Diagrams

## ğŸ”´ Old Setup: Local PCAP Replay (Not What You Want)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Your IDS System (Laptop)             â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚ 05_replay       â”‚                       â”‚
â”‚  â”‚ _traffic.sh     â”‚                       â”‚
â”‚  â”‚ (tcpreplay)     â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚           â”‚                                 â”‚
â”‚           â–¼ (loopback/same interface)      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚  USB Adapter    â”‚                       â”‚
â”‚  â”‚  enx00e04c...   â”‚                       â”‚
â”‚  â”‚  AF_PACKET      â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚           â”‚                                 â”‚
â”‚           â–¼                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚    Suricata     â”‚â†’ Kafka â†’ ML Pipeline  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âŒ Problem: Everything runs on same system
```

---

## âœ… New Setup: External Traffic Source (What You Want!)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  External Device     â”‚              â”‚   Your IDS System        â”‚
â”‚  (Traffic Source)    â”‚              â”‚   (Laptop)               â”‚
â”‚                      â”‚              â”‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   Ethernet   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  tcpreplay     â”‚  â”‚    Cable     â”‚  â”‚   USB Adapter      â”‚ â”‚
â”‚  â”‚  or            â”‚  â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â–¶â”‚  â”‚   enx00e04c...     â”‚ â”‚
â”‚  â”‚  scapy         â”‚  â”‚              â”‚  â”‚   192.168.100.1    â”‚ â”‚
â”‚  â”‚  or            â”‚  â”‚              â”‚  â”‚   (AF_PACKET)      â”‚ â”‚
â”‚  â”‚  hping3        â”‚  â”‚              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”‚  or            â”‚  â”‚              â”‚            â”‚            â”‚
â”‚  â”‚  metasploit    â”‚  â”‚              â”‚            â–¼            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚                      â”‚              â”‚  â”‚    Suricata        â”‚ â”‚
â”‚  eth0: 192.168.100.2 â”‚              â”‚  â”‚    (IDS)           â”‚ â”‚
â”‚                      â”‚              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  Examples:           â”‚              â”‚            â”‚            â”‚
â”‚  â€¢ Kali Linux        â”‚              â”‚            â–¼            â”‚
â”‚  â€¢ Raspberry Pi      â”‚              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â€¢ Another PC        â”‚              â”‚  â”‚      Kafka         â”‚ â”‚
â”‚  â€¢ VM                â”‚              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚            â”‚            â”‚
                                      â”‚            â–¼            â”‚
                                      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                                      â”‚  â”‚   ML Consumer      â”‚ â”‚
                                      â”‚  â”‚   (Predictions)    â”‚ â”‚
                                      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… Benefits:
   â€¢ Realistic traffic flow
   â€¢ Separate attack generation
   â€¢ Can use any PCAP replay tool
   â€¢ External device dedicated to traffic generation
   â€¢ Your laptop focuses on detection
```

---

## ğŸŒ Network Addressing

```
192.168.100.0/24 Network

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                         â”‚
â”‚  192.168.100.1        USB Adapter                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     (Your IDS System)                â”‚
â”‚  â”‚ enx00e04c... â”‚                                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚         â”‚                                               â”‚
â”‚         â”‚ Ethernet Cable                                â”‚
â”‚         â”‚                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚  â”‚     eth0     â”‚     192.168.100.2                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     (External Device)                â”‚
â”‚                                                         â”‚
â”‚  You can add more devices:                             â”‚
â”‚  â€¢ 192.168.100.3 - Second attack generator             â”‚
â”‚  â€¢ 192.168.100.4 - Third attack generator              â”‚
â”‚  â€¢ etc.                                                â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¡ Traffic Flow Diagram

```
External Device â†’ USB Adapter â†’ Suricata â†’ Kafka â†’ ML Consumer
(192.168.100.2)   (enx00e04c..)  (IDS)     (Bus)   (Detector)
                  (192.168.100.1)

Step-by-Step:
â”Œâ”€â”€â”€â”€â”€â”
â”‚  1  â”‚ External device sends packets via Ethernet
â””â”€â”€â”¬â”€â”€â”˜
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”
â”‚  2  â”‚ USB adapter receives packets (promiscuous mode)
â””â”€â”€â”¬â”€â”€â”˜
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”
â”‚  3  â”‚ AF_PACKET passes packets to Suricata
â””â”€â”€â”¬â”€â”€â”˜
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”
â”‚  4  â”‚ Suricata analyzes traffic, generates alerts
â””â”€â”€â”¬â”€â”€â”˜
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”
â”‚  5  â”‚ Alerts sent to Kafka topic
â””â”€â”€â”¬â”€â”€â”˜
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”
â”‚  6  â”‚ ML Consumer reads from Kafka
â””â”€â”€â”¬â”€â”€â”˜
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”
â”‚  7  â”‚ ML model predicts attack type
â””â”€â”€â”¬â”€â”€â”˜
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”
â”‚  8  â”‚ Results logged and can trigger actions
â””â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ Physical Connection Options

### Option 1: Direct Connection (Simplest)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  External    â”‚  Ethernet Cable    â”‚  IDS System  â”‚
â”‚  Device      â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–¶â”‚  USB Adapter â”‚
â”‚  (eth0)      â”‚                    â”‚  (enx00e0..) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Option 2: Through Switch (Multiple Devices)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  External    â”‚
â”‚  Device 1    â”‚â•â•â•â•â•—
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â•‘
                    â•‘     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â•‘     â”‚          â”‚     â”‚  IDS System  â”‚
â”‚  External    â”‚â•â•â•â•â•¬â•â•â•â•â–¶â”‚  Switch  â”‚â•â•â•â•â–¶â”‚  USB Adapter â”‚
â”‚  Device 2    â”‚â•â•â•â•â•£     â”‚          â”‚     â”‚  (enx00e0..) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â•‘     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â•‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â•‘
â”‚  External    â”‚â•â•â•â•â•
â”‚  Device 3    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Option 3: SPAN/Mirror Port (Production Network)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Production  â”‚                â”‚ Managed  â”‚
â”‚  Device A    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–¶â”‚ Switch   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚          â”‚
                                â”‚  SPAN    â”‚â•â•â•â•â–¶ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚  Port    â”‚      â”‚  IDS System  â”‚
â”‚  Production  â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–¶â”‚  Mirror  â”‚      â”‚  USB Adapter â”‚
â”‚  Device B    â”‚                â”‚          â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â–²
                        Copies all traffic to IDS
```

---

## ğŸ¯ Use Case Examples

### Use Case 1: Malware Analysis Lab
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Isolated Lab Network (192.168.100.0/24)         â”‚
â”‚                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Kali Linux   â”‚         â”‚ Your IDS         â”‚   â”‚
â”‚  â”‚ (Attacker)   â”‚â•â•â•â•â•â•â•â•â–¶â”‚ (Defender)       â”‚   â”‚
â”‚  â”‚ .100.2       â”‚         â”‚ .100.1           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                   â”‚
â”‚  Run attacks, capture everything!                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Use Case 2: PCAP Replay Testing
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Testing Environment                              â”‚
â”‚                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Raspberry Pi â”‚         â”‚ Your IDS         â”‚   â”‚
â”‚  â”‚ (Replayer)   â”‚â•â•â•â•â•â•â•â•â–¶â”‚ (Analyzer)       â”‚   â”‚
â”‚  â”‚ .100.2       â”‚         â”‚ .100.1           â”‚   â”‚
â”‚  â”‚              â”‚         â”‚                  â”‚   â”‚
â”‚  â”‚ tcpreplay    â”‚         â”‚ Suricata + ML    â”‚   â”‚
â”‚  â”‚ CICIDS2017   â”‚         â”‚                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Use Case 3: Multi-Attacker Simulation
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Advanced Testing Environment                        â”‚
â”‚                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚ Device 1 â”‚                                        â”‚
â”‚  â”‚ DDoS     â”‚â•â•â•â•â•—                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â•‘                                   â”‚
â”‚                  â•‘    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â•‘    â”‚        â”‚   â”‚  Your IDS   â”‚  â”‚
â”‚  â”‚ Device 2 â”‚â•â•â•â•â•¬â•â•â•â–¶â”‚ Switch â”‚â•â•â–¶â”‚  All-in-One â”‚  â”‚
â”‚  â”‚ Scan     â”‚â•â•â•â•â•£    â”‚        â”‚   â”‚  Detection  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â•‘    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                  â•‘                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â•‘                                   â”‚
â”‚  â”‚ Device 3 â”‚â•â•â•â•â•                                   â”‚
â”‚  â”‚ Exploit  â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Data Flow with Protocols

```
External Device (192.168.100.2)
         â”‚
         â”‚ Ethernet Frame
         â”‚ [Src MAC: aa:bb:cc:dd:ee:ff]
         â”‚ [Dst MAC: 00:e0:4c:36:07:4c]
         â”‚
         â”‚ IP Packet
         â”‚ [Src IP: 192.168.100.2]
         â”‚ [Dst IP: 192.168.100.1 or any target]
         â”‚
         â”‚ TCP/UDP/ICMP
         â”‚ [Various ports and protocols]
         â”‚
         â–¼
USB Adapter (enx00e04c36074c)
         â”‚ Promiscuous mode captures ALL packets
         â”‚ Not just packets destined for this IP
         â”‚
         â–¼
AF_PACKET Socket
         â”‚ Raw packet delivery to userspace
         â”‚ Zero-copy when possible
         â”‚
         â–¼
Suricata IDS
         â”‚ Deep packet inspection
         â”‚ Pattern matching
         â”‚ Protocol analysis
         â”‚
         â–¼
Kafka Topic (suricata-alerts)
         â”‚ JSON formatted alerts
         â”‚ {event_type: "alert", ...}
         â”‚
         â–¼
ML Consumer
         â”‚ Feature extraction
         â”‚ Model inference
         â”‚ Threat classification
         â”‚
         â–¼
Logs & Actions
         â”‚ Alert logs
         â”‚ ML predictions
         â”‚ Optional: Block IP, notify admin, etc.
         â”‚
         â–¼
```

---

## ğŸ® Quick Start Topology

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     QUICK START                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 1: On IDS System
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ $ sudo ./00_setup_external_capture.sh  â”‚
â”‚   âœ“ Configures USB adapter            â”‚
â”‚   âœ“ IP: 192.168.100.1/24               â”‚
â”‚   âœ“ Promiscuous mode                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
Step 2: Connect Cable
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  External Device â•â•â•â•â•â•â•â–¶ USB Adapter  â”‚
â”‚   (eth0)                  (enx00e0..)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
Step 3: Configure External Device
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ $ sudo ip addr add 192.168.100.2/24   â”‚
â”‚   dev eth0                             â”‚
â”‚ $ sudo ip link set eth0 up            â”‚
â”‚ $ ping 192.168.100.1  # Test!         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
Step 4: Start IDS Pipeline
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ $ sudo ./quick_start.sh                â”‚
â”‚   Select: 1 (Start Complete Pipeline)  â”‚
â”‚   âœ“ Kafka                              â”‚
â”‚   âœ“ Suricata                           â”‚
â”‚   âœ“ ML Consumer                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
Step 5: Replay Traffic from External Device
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ $ sudo tcpreplay -i eth0 attack.pcap  â”‚
â”‚   â†’ Packets flow to IDS                â”‚
â”‚   â†’ Suricata detects attacks           â”‚
â”‚   â†’ ML classifies threats              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… Verification Checklist

```
IDS System Checks:
â”œâ”€ [ ] USB adapter has IP 192.168.100.1
â”œâ”€ [ ] Interface is UP and PROMISC
â”œâ”€ [ ] Can ping 192.168.100.2
â”œâ”€ [ ] Suricata is running
â”œâ”€ [ ] Kafka is running
â”œâ”€ [ ] ML consumer is running
â””â”€ [ ] tcpdump shows packets on enx00e04c36074c

External Device Checks:
â”œâ”€ [ ] Has IP 192.168.100.2/24
â”œâ”€ [ ] Interface is UP
â”œâ”€ [ ] Can ping 192.168.100.1
â”œâ”€ [ ] ARP entry exists for .100.1
â”œâ”€ [ ] Can replay PCAPs
â””â”€ [ ] tcpdump shows outgoing packets

Data Flow Checks:
â”œâ”€ [ ] Packets visible in tcpdump on IDS
â”œâ”€ [ ] Suricata eve.json being written
â”œâ”€ [ ] Kafka has messages in topic
â”œâ”€ [ ] ML consumer processing alerts
â””â”€ [ ] Predictions appearing in logs
```

**All green? You're capturing external traffic! ğŸ‰**
